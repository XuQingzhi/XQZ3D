<!DOCTYPE html>
<html>
<head>
    <title>XQZ3D-JavaScript</title>
    <style>
        html,body{
            height:100%;
            border:0;
            margin:0;
            padding:0;
        }
    </style>
</head>
<body style="overflow:-Scroll;overflow-y:hidden;">
    <canvas id="canvas"></canvas>
    <script src="./Functions.js"></script>
    <script>
        var clientheight = document.body.clientHeight;
        var clientwidth = document.body.clientWidth;
        var canvas = document.getElementById("canvas");
        canvas.width = clientwidth;
        canvas.height = clientheight;
        var ctx = canvas.getContext("2d");

        var camara1 = new camara(new vector4(0, 0, -10), new angle3(0, 0, 0), new vector2(clientwidth, clientheight), new vector2(2, 1), 1, clientheight*2);

        var obj1 = new obj([new vertex(new vector4(0, 0, 0)), new vertex(new vector4(0, 1, 0)), new vertex(new vector4(1, 0, 0)), new vertex(new vector4(1, 1, 0)), new vertex(new vector4(1, 0, 1)), new vertex(new vector4(1, 1, 1))], [new mesh(0, 1, 2), new mesh(1, 2, 3), new mesh(2, 3, 4), new mesh(3, 4, 5)], new vector4(0, 0, 0), new angle3(0, 0, 0));
        var obj2 = new obj([new vertex(new vector4(0, 0, 0)), new vertex(new vector4(0, 1, 0)), new vertex(new vector4(1, 0, 0)), new vertex(new vector4(1, 1, 0)), new vertex(new vector4(1, 0, 1)), new vertex(new vector4(1, 1, 1))], [new mesh(0, 1, 2), new mesh(1, 2, 3), new mesh(2, 3, 4), new mesh(3, 4, 5)], new vector4(2, 2, 2), new angle3(0, 0, 0));
        var obj3 = new obj([new vertex(new vector4(0, 0, 0)), new vertex(new vector4(0, 1, 0)), new vertex(new vector4(1, 0, 0)), new vertex(new vector4(1, 1, 0)), new vertex(new vector4(1, 0, 1)), new vertex(new vector4(1, 1, 1))], [new mesh(0, 1, 2), new mesh(1, 2, 3), new mesh(2, 3, 4), new mesh(3, 4, 5)], new vector4(1, 3, 6), new angle3(0, 0, 0));
        var obj4 = new obj([new vertex(new vector4(0, 0, 0)), new vertex(new vector4(0, 1, 0)), new vertex(new vector4(1, 0, 0)), new vertex(new vector4(1, 1, 0)), new vertex(new vector4(1, 0, 1)), new vertex(new vector4(1, 1, 1))], [new mesh(0, 1, 2), new mesh(1, 2, 3), new mesh(2, 3, 4), new mesh(3, 4, 5)], new vector4(35, 1, 8), new angle3(0, 0, 0));
        var obj5 = new obj([new vertex(new vector4(0, 0, 0)), new vertex(new vector4(0, 1, 0)), new vertex(new vector4(1, 0, 0)), new vertex(new vector4(1, 1, 0)), new vertex(new vector4(1, 0, 1)), new vertex(new vector4(1, 1, 1))], [new mesh(0, 1, 2), new mesh(1, 2, 3), new mesh(2, 3, 4), new mesh(3, 4, 5)], new vector4(12, 0, 0), new angle3(0, 0, 0));
        var obj6 = new obj([new vertex(new vector4(0, 0, 0)), new vertex(new vector4(0, 1, 0)), new vertex(new vector4(1, 0, 0)), new vertex(new vector4(1, 1, 0)), new vertex(new vector4(1, 0, 1)), new vertex(new vector4(1, 1, 1))], [new mesh(0, 1, 2), new mesh(1, 2, 3), new mesh(2, 3, 4), new mesh(3, 4, 5)], new vector4(6, 7, 2), new angle3(0, 0, 0));
        var obj7 = new obj([new vertex(new vector4(0, 0, 0)), new vertex(new vector4(0, 1, 0)), new vertex(new vector4(1, 0, 0)), new vertex(new vector4(1, 1, 0)), new vertex(new vector4(1, 0, 1)), new vertex(new vector4(1, 1, 1))], [new mesh(0, 1, 2), new mesh(1, 2, 3), new mesh(2, 3, 4), new mesh(3, 4, 5)], new vector4(5, 7, 8), new angle3(0, 0, 0));

        var ObjectList = [obj1, obj2, obj3, obj4, obj5, obj6, obj7];

        function MainLoop(){
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            LocalToWorld(ObjectList);
            WorldToCamara(ObjectList, camara1);
            PerspectiveProjection(ObjectList, camara1);

            PrintObjectMesh(ObjectList, ctx);

            window.requestAnimationFrame(MainLoop);
        }

        MainLoop();

        document.onkeydown=function(event){
        var e = event || window.event || arguments.callee.caller.arguments[0];
        if(e && e.keyCode==65){ // 按 A 
            camara1.Position.x -= 0.1;
        }
        if(e && e.keyCode==68){ // 按 D 
            camara1.Position.x += 0.1;
        }
        if(e && e.keyCode==83){ // 按 S 
            camara1.Position.z -= 0.1;
        }
        if(e && e.keyCode==87){ // 按 W 
            camara1.Position.z += 0.1;
        }
        if(e && e.keyCode==74){ // 按 J 
            camara1.Position.y -= 0.1;
        }
        if(e && e.keyCode==75){ // 按 K 
            camara1.Position.y += 0.1;
        }
    };
    </script>
</body>
</html>
